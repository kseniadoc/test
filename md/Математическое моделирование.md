##Математическое моделирование
На этапе математического моделирования была разработана методика численного моделирования распространения электромагнитных волн по волноводу лазерной наногетероструктуры раздельного ограничения. Как отмечалось выше, при моделировании лазерной наногетероструктуры распространение электромагнитной волны позволяет рассчитать факторы оптического ограничения слоев активной области (квантовые ямы), волноводных и эмиттерных слоев. 
При выборе конструкции лазерной наногетероструктуры особенно важно знание факторов оптического ограничения в эмиттерных слоях. В соответствии с положениями концепции мощных полупроводниковых лазеров для снижения внутренних оптических потерь необходимо расширение волноводных слоев лазерной наногетероструктуры раздельного ограничения. Однако это ведет к возникновению мод высших порядков, росту внутренних оптических потерь, падению дифференциальной квантовой эффективности и оптической мощности.
Однако, если фактор оптического ограничения эмиттерного слоя для нулевой моды меньше факторов оптического ограничения для мод высших порядков, то внутренние оптические потери для мод высших порядков в сильно легированных эмиттерных слоях выше и их генерация подавлена.
Таким образом, математическое моделирование позволяет определить
выполнение основного требования к лазерной наногетероструктуре – условие генерации на нулевой моде в лазерной наногетероструктуре с расширенным волноводом.

Волновое уравнение в этом случае принимает вид:
![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/eq1.png)

Где ***β=k<SUB>0</SUB>n=2πn/λ*** - эффективный показатель преломления
волноводной моды. В этом уравнении константа распространения плоской волны определяется как

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/2.png)

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/3.png)

Уравнение (1) решается численным конечно-разностным методом,
который заключается в нанесении сетки некоторого конечного периода на
поперечное сечение волновода. Затем дифференциальное уравнение (1)
преобразуется в систему конечно-разностных уравнений, определённых в узловых точках. Результатом  решения системы будет поперечное поле волны U(x,y) в узлах сетки. Собственным значением этой системы линейных уравнений будет эффективный показатель преломления n рассматриваемой моды. Таким образом, осуществляется переход от прямого решения дифференциального уравнения в частных производных к задаче на поиск собственных значений, которая решается методами линейной алгебры.



##Процедура метода прогонки:
1)Выбор расчётной области. На границе области поле равно нулю. Задается
оптимальный размер расчётной области для достижения более точного результата.

2) Дискретизация расчётной области. Пусть сетка будет однородной. Координаты (x,
y) узла решётки через номер узла (i, j) и шаг сетки по x (Δx) и по y (Δy):

__x=iΔx , i = 0, 1, 2, …, I + 1__

__y=jΔy , j = 0, 1, 2, …, J + 1__

Запишем оператор Гамильтона в декартовых координатах и вынесем за скобки
волновое число k<SUB>0</SUB> из второго слагаемого в уравнении (1), при этом в скобках
останется разность квадратов профиля показателя преломления n(x, y) и
эффективного модального показателя преломления n . Уравнение (1) примет
следующий вид:
![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/4.png)
Прибегнем к конечно-разностной аппроксимации частных производных. Для
этого разложим функцию U в соседней узловой точке в ряд Тейлора второго
порядка:
![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/5.png)
Из этой системы уравнений  выразим вторую производную:__
![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/6.png)

Здесь можно пренебречь членами более высокого порядка, т.к. размер сетки
достаточно мал. Такое же выражение можно получить для второй производной по y.

После дискретизации расчётной области нам потребуются лишь значения
функции U в узлах. Поэтому проведём следующую замену:
![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/7.png)
Тогда, 

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/8.png)

Теперь скалярное волновое уравнение можно переписать в дискретной форме:

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/9.png)
Для упрощения расчёта поделим обе части уравнения на k<SUP>2</SUP><SUB>0</SUB> и введём
безразмерные величины:

__ΔX<SUP>2</SUP>=k<SUP>2</SUP><SUB>0</SUB>Δx<SUP>2</SUP>__

__ΔY<SUP>2</SUP>=k<SUP>2</SUP><SUB>0</SUB>Δy<SUP>2</SUP>__

Теперь перепишем уравнение в виде характеристического уравнения матрицы для i от i = 0 до i + 1 и для j от j = 0 до j + 1:

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/10.png)

где U<SUP>i</SUP><SUB>j</SUB> и n<SUP>i</SUP><SUB>j</SUB>
 - нормированное электрическое поле и показатель преломления в
узловой точке (i, j); ΔX=k<SUB>0</SUB>Δx,
ΔY=k<SUB>0</SUB>Δy ,– нормированные шаги между узловыми
точками.

Граничное условие: на границах расчётной области поле должно быть равно нулю:U<SUP>0</SUP><SUB>j</SUB>=U<SUP>I+1</SUP><SUB>j</SUB>=U<SUP>i</SUP><SUB>0</SUB>=U<SUP>i</SUP><SUB>J+1</SUB>=0. Таким образом, нужно решить все уравнения из
области i x j .
Преобразуем уравнение  к виду:

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/11.png)

Запишем в виде вектора-столбца функцию U для данной координаты x (i):


![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/12.png)


Для данного индекса i имеем J уравнений и можем
записать матричное разностное уравнение вдоль x:

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/13.png)

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/14.png)

где I – единичная матрица размерностью J x J .
Теперь запишем уравнения (всего I уравнений) в матричной форме:


![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/15.png)

Здесь A представляет собой матрицу I x I , элементы которой сами по себе
есть матрицы J x J , а U – вектор длиной I, компоненты которого сами есть вектора
каждый длиной J. Далее каждый элемент матрицы A разворачиваем в блок J x J , так
что A становится матрицей (IJ) x (IJ), элементы которой – скалярные величины.
Аналогично поступаем с компонентами вектора U.
Решение для TE моды, когда электрическое поле E поляризовано вдоль y,
сводится к решению уравнения для одномерного случая:

![1](https://raw.githubusercontent.com/DQE-Polytech-University/Beamplex/master/doc/16.png)

Здесь показатель преломления не меняется вдоль y:n<SUB>i</SUB>=n<SUB>j</SUB><SUP>j</SUP>, а U<SUB>i</SUB>=U<SUB>j</SUB><SUP>j</SUP>, т.к. j
принимает единственное значение.
В результате решения конечно-разностного матричного уравнения одним из
матричных методов можно найти собственное
число (квадрат эффективного показателя преломления) n<SUP>2</SUP>,  и собственный вектор U
(профиль моды).

Таким образом, математическое моделирование позволяет определить
выполнение основного требования к лазерной гетероструктуре – условие
генерации на нулевой моде с расширенным
волноводом.